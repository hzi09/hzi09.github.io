---
title:  "[TIL] ë‚´ì¼ë°°ì›€ìº í”„ 42ì¼ì°¨_[ML] Titanic ë°ì´í„°ë¥¼ ì‚¬ìš©í•œ ë¨¸ì‹ ëŸ¬ë‹(2)" 

categories: 
    - TIL
tags: 
    - TIL
    - ë‚´ì¼ë°°ì›€ìº í”„
    - ë¨¸ì‹ ëŸ¬ë‹


toc: True
toc_sticky: True
---

![TIL](/assets/images/TIL2.png){: .align-center style="width:35%;"}

# ğŸ‘€Today I Learn
## ëª¨ë¸ í•™ìŠµ
- K-Fold êµì°¨ê²€ì¦
  - ì§‘í•©ì„ ì²´ê³„ì ìœ¼ë¡œ ë°”ê¿”ê°€ë©´ì„œ ëª¨ë“  ë°ì´í„°ì— ëŒ€í•´ ëª¨í˜•ì˜ ì„±ê³¼ë¥¼ ì¸¡ì •í•˜ëŠ” ê²€ì¦ ë°©ì‹

    ![image](https://github.com/user-attachments/assets/fd8a27d6-d83b-4f24-bd48-ce517d484c0c){: width="35%" height="35%"}

- K-Fold êµì°¨ê²€ì¦
    ```python
    # for ë¬¸
    from sklearn.model_selection import KFold
    import numpy as np

    def exec_kfold(clf, folds=5):
        kfold = KFold(n_splits=folds)
        scores = []
        for iter_count, (train_index, test_index) in enumerate(kfold.split(X_titanic_df)):
            X_train, X_test = X_titanic_df.values[train_index], X_titanic_df.values[test_index]
            y_train, y_test = y_titanic_df.values[train_index], y_titanic_df.values[test_index]

            clf.fit(X_train, y_train)
            predictions = clf.predict(X_test)

            accuracy = accuracy_score(y_test, predictions)
            scores.append(accuracy)
            print(f'êµì°¨ ê²€ì¦ {iter_count} ì •í™•ë„: {accuracy:.4f}')

        mean_score = np.mean(scores)
        print(f'í‰ê·  ì •í™•ë„: {mean_score:.4f}')

    exec_kfold(DecisionTreeClassifier(random_state=11))
    ```

- ê²°ê³¼
    ```
    êµì°¨ ê²€ì¦ 0 ì •í™•ë„: 0.7542
    êµì°¨ ê²€ì¦ 1 ì •í™•ë„: 0.7809
    êµì°¨ ê²€ì¦ 2 ì •í™•ë„: 0.7865
    êµì°¨ ê²€ì¦ 3 ì •í™•ë„: 0.7697
    êµì°¨ ê²€ì¦ 4 ì •í™•ë„: 0.8202
    í‰ê·  ì •í™•ë„: 0.7823
    ```

<br>

## cross_val_score()
- êµì°¨ê²€ì¦ì„ ìœ„í•œ í•¨ìˆ˜
  - ì£¼ì–´ì§„ ë°ì´í„°ì…‹ì„ 'k'ê°œì˜ foldë¡œ ë¶„í• í•˜ê³ , ê° foldì—ì„œ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê³  ê²€ì¦í•˜ëŠ” ê³¼ì •ì„ 'k'ë²ˆ ë°˜ë³µí•˜ì—¬ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í‰ê°€
  - ì¥ì 
    - ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ë”ìš± ì •í™•í•˜ê²Œ ì˜ˆì¸¡ ê°€ëŠ¥
    - ê³¼ì í•©ì„ ë°©ì§€í•˜ê³ , ëª¨ë¸ì´ ì¼ë°˜í™” ë  ìˆ˜ ìˆë„ë¡í•¨
    - ëª¨ë¸ì˜ ì‹ ë¢°ë„ë¥¼ ë†’í ìˆ˜ ìˆìŒ
  - ë‹¨ì 
    - ê³„ì‚° ë¹„ìš©ì´ ë§¤ìš° ë†’ì„ ìˆ˜ ìˆìŒ

- `cross_val_score()`
    ```python
    from sklearn.model_selection import cross_val_score

    scores = cross_val_score(DecisionTreeClassifier(random_state=44), X_titanic_df, y_titanic_df, cv=5)

    for iter_count, accuracy in enumerate(scores):
        print(f'êµì°¨ ê²€ì¦: {iter_count}, ì •í™•ë„: {accuracy}')
    print(f'í‰ê·  ì •í™•ë„ >>>> {np.mean(scores):.4f}')
    ```

- ê²°ê³¼
    ```
    êµì°¨ ê²€ì¦: 0, ì •í™•ë„: 0.7653631284916201
    êµì°¨ ê²€ì¦: 1, ì •í™•ë„: 0.7752808988764045
    êµì°¨ ê²€ì¦: 2, ì •í™•ë„: 0.797752808988764
    êµì°¨ ê²€ì¦: 3, ì •í™•ë„: 0.7808988764044944
    êµì°¨ ê²€ì¦: 4, ì •í™•ë„: 0.8258426966292135
    í‰ê·  ì •í™•ë„ >>>> 0.7890
    ```

<br>

## í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹
### 1. ì¡°í•© ì •ì˜
- depth : ë„ˆë¬´ ê¹Šìœ¼ë©´ ê³¼ì í•©ì´ ë  ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§
- split : ì‘ìœ¼ë©´ ì‘ì„ìˆ˜ë¡ íŠ¸ë¦¬ê°€ ë³µì¡í•´ì§
- leaf : ë¦¬í”„ ë…¸ë“œê°€ ìµœì†Œí•œì˜ ë°ì´í„°ë¥¼ í¬í•¨í•˜ë„ë¡ ì„¤ì •

```python
# ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°
from sklearn.model_selection import GridSearchCV
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score

parameters = {'max_depth': [2, 3, 5, 10],
            'min_samples_split': [2, 3, 5],
            'min_samples_leaf': [1, 5, 8]}
```
- ì´ ê²½ìš° ì¡°í•©ì˜ ê°œìˆ˜ëŠ” 4 Ã— 3 Ã— 3 = 36

### 2. êµì°¨ê²€ì¦
```python
grid_dclf = GridSearchCV(
    estimator=DecisionTreeClassifier(random_state=44),
    param_grid=parameters,
    scoring='accuracy',
    cv=5
)

grid_dclf.fit(X_titanic_df, y_titanic_df)
```

### 3. ìµœì ì˜ ì¡°í•© ì„ íƒ
```python
print(f'ìµœì ì˜ íŒŒë¼ë¯¸í„° >>>> {grid_dclf.best_params_}')
print(f'ìµœê³  êµì°¨ ê²€ì¦ ì •í™•ë„ >>>> {grid_dclf.best_score_}')
```
- ê²°ê³¼
    ```
    ìµœì ì˜ íŒŒë¼ë¯¸í„° >>>> {'max_depth': 10, 'min_samples_leaf': 8, 'min_samples_split': 2}
    ìµœê³  êµì°¨ ê²€ì¦ ì •í™•ë„ >>>> 0.8159751428033394
    ```

### 4. ìµœì ì˜ ëª¨ë¸ ë°˜í™˜
```python
st_model = grid_dclf.best_estimator_
best_model
pred = best_model.predict(X_titanic_df)

print(f'GridSearchCV ìµœì ì˜ ê°’ >>>> {accuracy_score(y_titanic_df, pred)}')
```

- ê²°ê³¼
    ```
    GridSearchCV ìµœì ì˜ ê°’ >>>> 0.8720538720538721
    ```

<br>
<br>


# ğŸ’¡Today I Thought

## ì˜¤ëŠ˜ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [x]  ì•Œê³ ë¦¬ì¦˜ ì½”ë“œì¹´íƒ€ 91-100
- [x]  SQL ì½”íŠ¸ì¹´íƒ€ 61
- [x]  ë°±ì¤€ ì½”ë”©í…ŒìŠ¤íŠ¸ 1ë¬¸ì œ
- [x]  ì¥ê³  ê°•ì˜ 18ê°•ê¹Œì§€
- [x]  ìŠ¤íƒ ë‹¤ë“œë°˜ ê³¼ì œ
- [x]  TIL ì‘ì„±

## íšŒê³ 
&nbsp; ì˜¤ëŠ˜ì€ ëª©í‘œ ì™„ë£Œ! ì›ë˜ëŠ” 20ê°•ê¹Œì§€ ë“¤ìœ¼ë ¤ê³  í–ˆëŠ”ë°, ìƒê°ë³´ë‹¤ 18ê°•ì´ ì˜¤ë˜ ê±¸ë ¸ë‹¤.(117ë¶„ ê°•ì˜ëŠ” í˜ë“¤ë‹¤.. ëë‚˜ì§€ ì•Šì•„..) ë¨¸ì‹ ëŸ¬ë‹ ì •ë¦¬ë„ ë! ì¡°ê¸ˆ ìì„¸í•œ ë‚´ìš©ì€ ë”°ë¡œ ê³µë¶€í•´ì„œ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‚¨ê²¨ë‘¬ì•¼ì§€! ì´ì œ ê³¼ì œë°œì œê°€ ì–¼ë§ˆ ì•ˆë‚¨ì•˜ìœ¼ë‹ˆê¹Œ ë‚´ì¼ì€ ì¥ê³  ê¸°ì´ˆ ê°•ì˜ ê¼­ ëë‚´ê³  ì‹¬í™” ì‹œì‘í•´ì•¼ê² ë‹¤.ğŸ˜°