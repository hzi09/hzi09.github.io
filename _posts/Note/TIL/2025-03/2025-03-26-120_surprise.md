---
title:  "[TIL] ë‚´ì¼ë°°ì›€ìº í”„ 120ì¼ì°¨_[ML] Surprise ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•œ ì¶”ì²œ ì‹œìŠ¤í…œ" 

categories: 
    - TIL
tags: 
    - TIL
    - ë‚´ì¼ë°°ì›€ìº í”„
    - ë¨¸ì‹ ëŸ¬ë‹
    - scikit surprise


toc: True
toc_sticky: True
---

![TIL](/assets/images/TIL2.png){: .align-center style="width:35%;"}

# ğŸ‘€Today I Learn
## Surprise ë¼ì´ë¸ŒëŸ¬ë¦¬ë€?

- SurpriseëŠ” Scikit-learn ìŠ¤íƒ€ì¼ì˜ APIë¥¼ ì œê³µí•˜ëŠ” ì¶”ì²œ ì‹œìŠ¤í…œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, ë‹¤ì–‘í•œ í˜‘ì—… í•„í„°ë§ ì•Œê³ ë¦¬ì¦˜ì„ ì§€ì›
- íŠ¹íˆ, ì‚¬ìš©ì-ì•„ì´í…œ í‰ì  ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ë° ìµœì í™”ë˜ì–´ ìˆìœ¼ë©°, ë‹¤ì–‘í•œ í‰ê°€ ì§€í‘œë¥¼ ì œê³µí•˜ì—¬ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ë¶„ì„í•  ìˆ˜ ìˆìŒ

### ì£¼ìš” íŠ¹ì§•

- ë‹¤ì–‘í•œ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ ì œê³µ (SVD, KNN, NMF ë“±)
- ê°„í¸í•œ ë°ì´í„° ë¡œë”© ë° í•™ìŠµ
- ì»¤ìŠ¤í…€ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ê°€ëŠ¥
- RMSE, MAE ë“±ì˜ í‰ê°€ ì§€í‘œ ì œê³µ

<br>

## Surprise ì„¤ì¹˜í•˜ê¸°
- SurpriseëŠ” pipì„ ì´ìš©í•˜ì—¬ ê°„ë‹¨íˆ ì„¤ì¹˜í•  ìˆ˜ ìˆìŒ

    ```bash
    pip install scikit-surprise
    ```

- ì„¤ì¹˜ í›„ ì •ìƒì ìœ¼ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸

    ```bash
    import surprise
    print(surprise.__version__)
    ```

<br>

## Surpriseë¥¼ ì´ìš©í•œ ì¶”ì²œ ì‹œìŠ¤í…œ êµ¬í˜„

### (1) ë°ì´í„° ë¡œë“œ

- SurpriseëŠ” Movielensì™€ ê°™ì€ ê³µê°œ ë°ì´í„°ì…‹ì„ ì‰½ê²Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ```python
    from surprise import Dataset
    from surprise.model_selection import train_test_split

    # Movielens 100k ë°ì´í„° ë¡œë“œ
    data = Dataset.load_builtin('ml-100k')
    trainset, testset = train_test_split(data, test_size=0.2)
    ```


### (2) SVD ëª¨ë¸ í•™ìŠµ ë° í‰ê°€

- SVD(Singular Value Decomposition) ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ì¶”ì²œ ëª¨ë¸ì„ í•™ìŠµ

    ```python
    from surprise import SVD
    from surprise import accuracy
    from surprise.model_selection import cross_validate

    # SVD ëª¨ë¸ ìƒì„±
    model = SVD()

    # ëª¨ë¸ í•™ìŠµ
    model.fit(trainset)

    # ì˜ˆì¸¡ ìˆ˜í–‰
    predictions = model.test(testset)

    # RMSE í‰ê°€
    rmse = accuracy.rmse(predictions)
    print(f"RMSE: {rmse}")
    ```

### (3) íŠ¹ì • ì‚¬ìš©ìì—ê²Œ ì˜í™” ì¶”ì²œí•˜ê¸°

- í•™ìŠµëœ ëª¨ë¸ì„ ì´ìš©í•˜ì—¬ íŠ¹ì • ì‚¬ìš©ìì—ê²Œ ë§ì¶¤í˜• ì¶”ì²œì„ ì œê³µ

    ```python
    # íŠ¹ì • ì‚¬ìš©ì(user_id = 196)ì˜ ì˜í™”(movie_id = 302)ì— ëŒ€í•œ ì˜ˆìƒ í‰ì  ì˜ˆì¸¡
    user_id = str(196)
    item_id = str(302)

    pred = model.predict(user_id, item_id)
    print(f"ì˜ˆìƒ í‰ì : {pred.est}")
    ```

### (4) ì „ì²´ ì˜í™” ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ ìƒì„±

- ì‚¬ìš©ìê°€ ì•„ì§ í‰ê°€í•˜ì§€ ì•Šì€ ì˜í™”ì— ëŒ€í•œ ì¶”ì²œ ëª©ë¡ì„ ìƒì„±í•  ìˆ˜ë„ ìˆìŒ

    ```python
    def get_top_n_recommendations(predictions, n=10):
        from collections import defaultdict
        
        top_n = defaultdict(list)
        for pred in predictions:
            top_n[pred.uid].append((pred.iid, pred.est))
        
        # ì˜ˆì¸¡ í‰ì  ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
        for uid, user_ratings in top_n.items():
            user_ratings.sort(key=lambda x: x[1], reverse=True)
            top_n[uid] = user_ratings[:n]
        
        return top_n

    # ëª¨ë“  ì‚¬ìš©ìì— ëŒ€í•œ ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ ìƒì„±
    top_n_recs = get_top_n_recommendations(predictions, n=5)

    # íŠ¹ì • ì‚¬ìš©ì(196) ì¶”ì²œ ëª©ë¡ í™•ì¸
    print(f"User 196 ì¶”ì²œ ì˜í™”: {top_n_recs['196']}")
    ```

<br>

## ë‹¤ì–‘í•œ ì•Œê³ ë¦¬ì¦˜ ì ìš©

- SurpriseëŠ” SVD ì™¸ì—ë„ ì—¬ëŸ¬ ì•Œê³ ë¦¬ì¦˜ì„ ì§€ì›

### KNN ê¸°ë°˜ í˜‘ì—… í•„í„°ë§

```python
from surprise import KNNBasic

sim_options = {'name': 'cosine', 'user_based': True}
model = KNNBasic(sim_options=sim_options)
model.fit(trainset)
predictions = model.test(testset)
accuracy.rmse(predictions)
```

## ì°¸ê³  ìë£Œ

- Surprise ê³µì‹ ë¬¸ì„œ: [https://surprise.readthedocs.io/](https://surprise.readthedocs.io/)
- Movielens ë°ì´í„°ì…‹: [https://grouplens.org/datasets/movielens/](https://grouplens.org/datasets/movielens/)

# ğŸ’¡Today I Thought

## ì˜¤ëŠ˜ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [x]  ì•Œê³ ë¦¬ì¦˜ ì½”ë“œì¹´íƒ€ 1ë¬¸ì œ
- [x]  SQL ì½”ë“œì¹´íƒ€ 1ë¬¸ì œ
- [x]  í”„ë¡ íŠ¸ ì˜¤ì „ ì¤‘ì— ì¬ì •ë¹„
- [x]  2ì°¨ ìœ ì €í…ŒìŠ¤íŠ¸ ì˜¬ë¦¬ê¸°
- [x]  ML ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê°œì„  - ing
- [ ]  README ì‘ì„±
- [x]  TIL ì‘ì„±

## íšŒê³ 
&nbsp;ë‚´ì¼ README ì´ˆì•ˆ ì‘ì„±í•´ì•¼ì§€.. ë§¤ì¼ë§¤ì¼ í•´ì•¼í•˜ëŠ”ê²Œ ì‚°ë”ë¯¸ë‹¤.. í•´ì•¼í•˜ëŠ”ê²Œ ë„ˆë¬´ ë§ì•„..ğŸ¥º