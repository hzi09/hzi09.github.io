---
title:  "[TIL] ë‚´ì¼ë°°ì›€ìº í”„ 103ì¼ì°¨_[Docker] Dockerë¥¼ í™œìš©í•œ React ê°œë°œ ë° ë°°í¬ í™˜ê²½ ì„¤ì •" 

categories: 
    - TIL
tags: 
    - TIL
    - ë‚´ì¼ë°°ì›€ìº í”„
    - Docker
    - React


toc: True
toc_sticky: True
---

![TIL](/assets/images/TIL2.png){: .align-center style="width:35%;"}

# ğŸ‘€Today I Learn
- Dockerë¥¼ ì´ìš©í•˜ì—¬ React í”„ë¡œì íŠ¸ë¥¼ ê°œë°œí•˜ê³  ë°°í¬í•˜ëŠ” ë°©ë²•ì„ ì •ë¦¬
  - ê°œë°œ í™˜ê²½ì—ì„œëŠ” ì½”ë“œ ë³€ê²½ ì‹œ ìë™ ë°˜ì˜ë˜ë„ë¡ ì„¤ì •
  - ë°°í¬ í™˜ê²½ì—ì„œëŠ” ì •ì  íŒŒì¼ì„ Nginxë¡œ ì„œë¹™í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±

## ê°œë°œ í™˜ê²½ vs ë°°í¬ í™˜ê²½ ì°¨ì´ì 
### ê°œë°œ í™˜ê²½ (Development)
- `npm start`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°œë°œ ì„œë²„ ì‹¤í–‰
- ì½”ë“œ ë³€ê²½ ì‹œ ìë™ ë°˜ì˜
- `docker-compose.yml`ì—ì„œ `3000:3000` í¬íŠ¸ ë§¤í•‘

### ë°°í¬ í™˜ê²½ (Production)
- `npm run build` í›„ ì •ì  íŒŒì¼ì„ ìƒì„±í•˜ì—¬ Nginxë¡œ ì„œë¹™
- ë³€ê²½ëœ ì½”ë“œê°€ ë°”ë¡œ ë°˜ì˜ë˜ì§€ ì•Šìœ¼ë©°, ë¹Œë“œ í›„ ë°°í¬ í•„ìš”
- `docker-compose.prod.yml`ì—ì„œ `3000:80` í¬íŠ¸ ë§¤í•‘

<br>

## ê°œë°œ í™˜ê²½ ì„¤ì •
### Dockerfile.dev
- `frontend/Dockerfile.dev` front ì•± ìµœìƒë‹¨ì— ìœ„ì¹˜

    ```Dockerfile
    # Node.js í™˜ê²½ ì„¤ì •
    FROM node:18

    # ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
    WORKDIR /app

    # package.json ë° package-lock.json ë³µì‚¬ í›„ ì˜ì¡´ì„± ì„¤ì¹˜
    COPY package.json package-lock.json ./
    RUN npm install

    # í”„ë¡œì íŠ¸ ì½”ë“œ ë³µì‚¬
    COPY . .

    # ê°œë°œ ì„œë²„ ì‹¤í–‰ (ì½”ë“œ ë³€ê²½ ì‹œ ìë™ ë°˜ì˜ë¨)
    CMD ["npm", "start"]
    ```

### docker-compose.yml
```yml
version: '3.8'

services:
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile.dev
    volumes:
      - ./frontend:/app
      - /app/node_modules
    ports:
      - "3000:3000"  # ê°œë°œ í™˜ê²½ì—ì„œëŠ” React Dev Serverê°€ 3000 í¬íŠ¸ì—ì„œ ì‹¤í–‰ë¨
    environment:
      - REACT_APP_API_URL=http://localhost:8000
    command: npm start
    stdin_open: true
    tty: true
    networks:
      - steamate-network

networks:
  steamate-network:
    driver: bridge
```

### ì‹¤í–‰

```bash
docker-compose up --build
```

<br>

## ë°°í¬ í™˜ê²½ ì„¤ì •
### Dockerfile.prod
```Dockerfile
# 1. Node.js í™˜ê²½ì—ì„œ React ë¹Œë“œ
FROM node:18 AS build

# 2. ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# 3. package.json ë° package-lock.json ë³µì‚¬ í›„ ì˜ì¡´ì„± ì„¤ì¹˜
COPY package.json package-lock.json ./
RUN npm install

# 4. í”„ë¡œì íŠ¸ ì½”ë“œ ë³µì‚¬ ë° React ë¹Œë“œ ì‹¤í–‰
COPY . .
RUN npm run build

# 5. Nginxë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ì  íŒŒì¼ ì„œë¹™
FROM nginx:latest
COPY --from=build /app/build /usr/share/nginx/html

# 6. Nginx ì‹¤í–‰
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

### docker-compose.prod.yml
```yml
version: '3.8'

services:
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile.prod
    ports:
      - "3000:80"  # ë°°í¬ í™˜ê²½ì—ì„œëŠ” Nginxê°€ 80 í¬íŠ¸ì—ì„œ ì‹¤í–‰ë¨
    networks:
      - steamate-network

networks:
  steamate-network:
    driver: bridge
```

### ë°°í¬ ì‹¤í–‰ ë°©ë²•
```bash
docker-compose -f docker-compose.prod.yml up --build
```

<br>
<br>

# ğŸ’¡Today I Thought

## ì˜¤ëŠ˜ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [x] ì•Œê³ ë¦¬ì¦˜ ì½”ë“œì¹´íƒ€ 1ë¬¸ì œ
- [x] SQL ì½”ë“œì¹´íƒ€ 1ë¬¸ì œ
- [x] Frontend ê°œë°œí™˜ê²½ êµ¬ì„±
- [x] TIL ì‘ì„±

## íšŒê³ 
&nbsp;ì˜¤ëŠ˜ì€ í”„ë¡ íŠ¸ë§Œ í•˜ë‹¤ê°€ ëë‚¬ëŠ”ë°ë„ ë¿Œë“¯í•˜ë‹¤. ì›ë˜ í™˜ê²½ ì„¤ì •í•˜ë©´ ë‹¤ í•œê±°ë¼ê³  í–ˆì–´.. ë‚´ì¼ì€ ë¼ˆëŒ€ ë‹¤ êµ¬ì¶•í•´ì•¼ê² ë‹¤.